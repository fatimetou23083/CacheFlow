<div class="weather-container">
  <div class="weather-header">
    <h1>ğŸŒ¤ï¸ Module MÃ©tÃ©o</h1>
    <p class="subtitle">Recherchez la mÃ©tÃ©o d'une ville avec cache Redis dynamique</p>
  </div>

  <!-- Formulaire de recherche -->
  <div class="search-section">
    <div class="search-form">
      <div class="input-group">
        <label for="city">Nom de la ville</label>
        <input type="text" id="city" [(ngModel)]="city" name="city" placeholder="Ex: Paris, London, New York..."
          class="form-control" (keypress)="onKeyPress($event)" />
      </div>
      <button type="button" class="btn btn-primary" (click)="getWeather()"
        [disabled]="loading || !city || city.trim() === ''">
        <span *ngIf="!loading">ğŸ” Rechercher</span>
        <span *ngIf="loading">â³ Chargement...</span>
      </button>
    </div>
  </div>

  <!-- Message d'erreur -->
  <div *ngIf="error" class="error-message">
    <p>âš ï¸ {{ error }}</p>
  </div>

  <!-- Affichage de la mÃ©tÃ©o -->
  <div *ngIf="weather && !loading" class="weather-card">
    <div class="weather-header-card">
      <h2>{{ weather.city }}</h2>
      <button class="btn btn-refresh" (click)="refreshCache()" [disabled]="refreshing"
        title="Forcer la mise Ã  jour du cache">
        <span *ngIf="!refreshing">ğŸ”„ RafraÃ®chir le cache</span>
        <span *ngIf="refreshing">â³ Mise Ã  jour...</span>
      </button>
    </div>

    <div class="weather-content">
      <div class="weather-item temperature">
        <div class="weather-icon">ğŸŒ¡ï¸</div>
        <div class="weather-info">
          <span class="weather-label">TempÃ©rature</span>
          <span class="weather-value">{{ weather.temp }}Â°C</span>
        </div>
      </div>

      <div class="weather-item humidity">
        <div class="weather-icon">ğŸ’§</div>
        <div class="weather-info">
          <span class="weather-label">HumiditÃ©</span>
          <span class="weather-value">{{ weather.humidity }}%</span>
        </div>
      </div>

      <div class="weather-item timestamp">
        <div class="weather-icon">ğŸ•</div>
        <div class="weather-info">
          <span class="weather-label">DerniÃ¨re mise Ã  jour</span>
          <span class="weather-value-small">{{ formatDate(weather.timestamp!) }}</span>
        </div>
      </div>
    </div>

    <div class="cache-info">
      <p class="info-text">
        ğŸ’¡ Les donnÃ©es sont mises en cache avec un TTL dynamique selon la saison :
        <strong>5 minutes en Ã©tÃ©</strong>, <strong>30 minutes en hiver</strong>,
        <strong>15 minutes en printemps/automne</strong>
      </p>
    </div>
  </div>

  <!-- Indicateur de chargement -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>RÃ©cupÃ©ration des donnÃ©es mÃ©tÃ©o...</p>
  </div>
</div>